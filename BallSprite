package com.example.workingwitheverything;

import java.util.List;
import android.content.Context;
import android.graphics.Point;
import android.view.Display;
import android.view.ViewGroup;
import android.view.WindowManager;
import android.widget.ImageView;
import android.widget.RelativeLayout;

public class BallSprite {
	private double moveX = 0;
	private double moveY = 0;
	private double velocityDegrade;
	private double radius;
	private ImageView ball;
	
	private double screenSizeX;
	private double screenSizeY;
	
	private int xSpawn;
	private int ySpawn;
	
	private int xOffset = 5, yOffset = 65;
	
	private Display userDevice;
	
	public BallSprite(RelativeLayout rLayout, Context context, int xLoc, int yLoc, int xSpawnTemp, int ySpawnTemp, int tempRadius, double velocityDegradeTemp) {
		
		ball = new ImageView(context);
		
		radius = tempRadius;
		
		ViewGroup.LayoutParams tempParam = new ViewGroup.LayoutParams((int)(radius * 2), (int)(radius * 2));
		ball.setLayoutParams(tempParam); 
		
		rLayout.addView(ball);
		
		ball.setImageResource(R.drawable.ball);

		ball.setX(xLoc + xOffset);
		ball.setY(yLoc + yOffset);
		
		xSpawn = (xSpawnTemp + xOffset);
		ySpawn = (ySpawnTemp + yOffset);
		
		velocityDegrade = velocityDegradeTemp;
		
		WindowManager wm = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);
		userDevice = wm.getDefaultDisplay();
		Point tempPoint = new Point();
		userDevice.getSize(tempPoint);
		
		screenSizeX = tempPoint.x;
		screenSizeY = tempPoint.y;
		
	}
	
	public void move() {
		
		ball.setX((float)(ball.getX() + moveX));
		ball.setY((float)(ball.getY() + moveY));
		
		
		
		moveX *= velocityDegrade;
		moveY *= velocityDegrade;
	}
	
	public boolean isCollidingWall(List<Object_Wall> walls, ObjectWallFinale owfTrophy) {
		
		squareCollide();
		Point pntTemp = new Point((int)(ball.getX() + radius), (int)(ball.getY() + radius));
		for (Object_Wall triedWall: walls) {
			if (triedWall.isCollisionWall(pntTemp, (int)moveX, (int)moveY)) {
				
				double moveTemp = 0.0;
				switch (triedWall.getCollisionSector()) {
				case 1:
					
					moveTemp = moveX;
					moveX = -moveY;
					moveY = -moveTemp;
					
					break;
				case 2:
					
					moveY *= -1;
					
					break;
				case 3:

					moveTemp = moveX;
					moveX = -moveY;
					moveY = -moveTemp;
					
					break;
				case 4:
					
					moveX *= -1;
					
					break;
				case 5:

					moveTemp = moveX;
					moveX = -moveY;
					moveY = -moveTemp;
					
					break;
				case 6:
					
					moveY *= -1;
					
					break;
				case 7:

					moveTemp = moveX;
					moveX = -moveY;
					moveY = -moveTemp;
					
					break;
				case 8:
					
					moveX *= -1;
					
					break;
				}
				
				triedWall.resetSector();
				
			}
		}
		 
		boolean win = false;
		if (owfTrophy.isCollisionWall(new Point((int)(ball.getX() + radius), (int)(ball.getY() + radius)), (int)moveX, (int)moveY)) {
			win = true;
		}
		
		return win;
	}
	
	public void updateMove(Point Finger) {
		
		moveX += ((double)ball.getX() - (double)Finger.x) / 25.0;
		moveY += ((double)ball.getY() - (double)Finger.y) / 25.0;
	}
	
	public void resetBall() {
		
		moveX = 0;
		moveY = 0;
		
		ball.setX(xSpawn);
		ball.setY(ySpawn);
	}
	
	public int getWidth() {
		
		int width = ball.getWidth();
		
		return width;
	}
	
	public int getHeight() {
		
		int height = ball.getHeight();
		
		return height;
	}
	
	public boolean isMoving() {
		
		boolean moving = true;
		if ((int)moveX == 0 && (int)moveY == 0) {
			moving = false;
		}
		
		return moving;
	}
	
	private void squareCollide() {
		
		if (ball.getX() + moveX < 5.0 || ball.getX() + moveX > screenSizeX - ball.getWidth() - 5) {
			
			moveX *= -1;
			
		}
		
		if (ball.getY() + moveY < 65.0 || ball.getY() + moveY > screenSizeY - ball.getHeight() - 5) {
			
			moveY *= -1;
			
		}	
	}	
}
